/**
 * An angular module that handle $http request error.
 * @version v0.0.1 - 2014-07-24
 * @link https://github.com/martinmicunda/mm-angular-error-http-handler
 * @author Martin Micunda
 * @copyright 2014(c) Martin Micunda
 * @license MIT, https://github.com/martinmicunda/mm-angular-error-http-handler/blob/master/LICENSE
 */
!function(){"use strict";function r(){var r={appErrorPrefix:"",ravenDns:null,ravenConfig:null,customDns:null};this.setConfigAppErrorPrefix=function(e){r.appErrorPrefix=e||r.appErrorPrefix},this.setConfigRavenDns=function(e){if(!e)throw new Error("RavenDNS must be set!");r.ravenDns=e},this.setConfigRavenConfig=function(e){r.ravenConfig=e||r.ravenConfig},this.setConfigCustomDns=function(e){if(!e)throw new Error("CustomeDNS must be set!");r.customDns=e},this.$get=["$injector","$q","$location","$window","Logger",function(e,n,t,o,a){var s=a.getLogger("$exceptionHandler"),i={navigatorAppName:navigator.appName,navigatorUserAgent:navigator.userAgent};if(o.Raven){s.info("Using the RavenJS server-side logging exception handler."),s.info("RavenJS ravenDns {0}",[r.ravenDns]),s.info("RavenJS ravenConfig {0}",[r.ravenConfig]);try{Raven.config(r.ravenDns,r.ravenConfig).install()}catch(u){s.error("Error to configure RavenJS"),s.error(u.toString())}}else r.customDns&&(s.info("Using the custom server-side logging exception handler."),s.info("Custom DNS {0}",[r.customDns]));return{responseError:function(a){try{if(o.Raven)Raven.captureException(new Error("HTTP response error"),{extra:{method:a.config.method,url:a.config.url,message:a.data,status:a.status,browserInfo:i}});else if(r.customDns){var u=e.get("$httpBackend");u("POST",r.customDns,angular.toJson({method:a.config.method,url:a.config.url,message:a.data,status:a.status,browserInfo:i}),angular.noop,{"content-type":"application/json"})}}catch(g){s.error("Error server-side logging failed"),s.error(g.toString())}switch(a.status){case 404:t.path("/404"),s.error("{0} {1} '{2}'",[a.status,a.statusText,a.config.url]);break;case 0:t.path("/500"),s.error("{0} {1} {2} '{3}'",[a.status,a.statusText,a.config.url,"Unable to communicate with the server. Make sure you are connected to the internet and try again."]);break;default:t.path("/500"),s.error("{0} {1} {2} '{3}'",[a.status,a.statusText,a.config.url,a.data.message])}return n.reject(a)}}}]}angular.module("mm.errorHttpHandler",["mm.logger"]).provider("errorHttpHandler",r).config(["$httpProvider",function(r){r.interceptors.push("errorHttpHandler")}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW0tYW5ndWxhci1lcnJvci1odHRwLWhhbmRsZXIuanMiLCJzb3VyY2VzIjpbIm1tLWFuZ3VsYXItZXJyb3ItaHR0cC1oYW5kbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJDQUNBLFdBQ0EsWUE0REEsU0FBQSxLQVVBLEdBQUEsSUFDQSxlQUFBLEdBQ0EsU0FBQSxLQUNBLFlBQUEsS0FDQSxVQUFBLEtBV0EsTUFBQSx3QkFBQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEdBQUEsRUFBQSxnQkFXQSxLQUFBLGtCQUFBLFNBQUEsR0FDQSxJQUFBLEVBQ0EsS0FBQSxJQUFBLE9BQUEsd0JBRUEsR0FBQSxTQUFBLEdBV0EsS0FBQSxxQkFBQSxTQUFBLEdBQ0EsRUFBQSxZQUFBLEdBQUEsRUFBQSxhQVdBLEtBQUEsbUJBQUEsU0FBQSxHQUNBLElBQUEsRUFDQSxLQUFBLElBQUEsT0FBQSwwQkFFQSxHQUFBLFVBQUEsR0FHQSxLQUFBLE1BQUEsWUFBQSxLQUFBLFlBQUEsVUFBQSxTQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLFVBQUEscUJBRUEsR0FDQSxpQkFBQSxVQUFBLFFBQ0EsbUJBQUEsVUFBQSxVQUVBLElBQUEsRUFBQSxNQUFBLENBQ0EsRUFBQSxLQUFBLDREQUNBLEVBQUEsS0FBQSx3QkFBQSxFQUFBLFdBQ0EsRUFBQSxLQUFBLDJCQUFBLEVBQUEsYUFDQSxLQUVBLE1BQUEsT0FBQSxFQUFBLFNBQUEsRUFBQSxhQUFBLFVBQ0EsTUFBQSxHQUNBLEVBQUEsTUFBQSw4QkFDQSxFQUFBLE1BQUEsRUFBQSxpQkFFQSxHQUFBLFlBQ0EsRUFBQSxLQUFBLDJEQUNBLEVBQUEsS0FBQSxrQkFBQSxFQUFBLFlBR0EsUUFDQSxjQUFBLFNBQUEsR0FDQSxJQUNBLEdBQUEsRUFBQSxNQUVBLE1BQUEsaUJBQUEsR0FBQSxPQUFBLHdCQUFBLE9BQ0EsT0FBQSxFQUFBLE9BQUEsT0FDQSxJQUFBLEVBQUEsT0FBQSxJQUNBLFFBQUEsRUFBQSxLQUNBLE9BQUEsRUFBQSxPQUNBLFlBQUEsU0FFQSxJQUFBLEVBQUEsVUFBQSxDQUVBLEdBQUEsR0FBQSxFQUFBLElBQUEsZUFHQSxHQUFBLE9BQUEsRUFBQSxVQUFBLFFBQUEsUUFDQSxPQUFBLEVBQUEsT0FBQSxPQUNBLElBQUEsRUFBQSxPQUFBLElBQ0EsUUFBQSxFQUFBLEtBQ0EsT0FBQSxFQUFBLE9BQ0EsWUFBQSxJQUNBLFFBQUEsTUFBQSxlQUFBLHNCQUVBLE1BQUEsR0FDQSxFQUFBLE1BQUEsb0NBQ0EsRUFBQSxNQUFBLEVBQUEsWUFFQSxPQUFBLEVBQUEsUUFDQSxJQUFBLEtBQ0EsRUFBQSxLQUFBLFFBQ0EsRUFBQSxNQUFBLGlCQUFBLEVBQUEsT0FBQSxFQUFBLFdBQUEsRUFBQSxPQUFBLEtBQ0EsTUFDQSxLQUFBLEdBRUEsRUFBQSxLQUFBLFFBQ0EsRUFBQSxNQUFBLHFCQUFBLEVBQUEsT0FBQSxFQUFBLFdBQUEsRUFBQSxPQUFBLElBQUEscUdBQ0EsTUFDQSxTQUNBLEVBQUEsS0FBQSxRQUNBLEVBQUEsTUFBQSxxQkFBQSxFQUFBLE9BQUEsRUFBQSxXQUFBLEVBQUEsT0FBQSxJQUFBLEVBQUEsS0FBQSxVQUdBLE1BQUEsR0FBQSxPQUFBLE9BTUEsUUFDQSxPQUFBLHVCQUFBLGNBQ0EsU0FBQSxtQkFBQSxHQUNBLFFBQUEsZ0JBQUEsU0FBQSxHQUNBLEVBQUEsYUFBQSxLQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIFJhdmVuOnRydWUgKi9cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKipcbiAgICAgKiBAbmdkb2MgbW9kdWxlXG4gICAgICogQG5hbWUgbW0uZXJyb3JIdHRwSGFuZGxlclxuICAgICAqXG4gICAgICogQGRlc2NyaXB0aW9uXG4gICAgICogVGhlIGBtbS5lcnJvckh0dHBIYW5kbGVyYCBtb2R1bGUgY2hlY2tzIGlmIGFueSAkaHR0cCByZXF1ZXN0IGhhcyBmYWlsZWQgYW5kIGlmIHNvIGF1dG9tYXRpY2FsbHkgcG9zdHMgdGhlIGVycm9yIHRvIHtAbGluayBodHRwczovL2dldHNlbnRyeS5jb20vIGBTZW50cnlgKVxuICAgICAqIG9yIHNvbWUgY3VzdG9tIHJlcG9ydGluZyB0b29sLiBGb3IgYW55IGh0dHAgZXJyb3IgeW91IHdpbGwgYmUgcmVkaXJlY3QgdG8gZm9sbG93IHBhZ2VzOlxuICAgICAqXG4gICAgICogLSA0MDQgZXJyb3Igc3RhdHVzIC0+IC80MDRcbiAgICAgKiAtIDAgZXJyb3Igc3RhdHVzICAgLT4gLzUwMFxuICAgICAqIC0gYW55IG90aGVyIGVycm9yICAtPiAvNTAwXG4gICAgICogPiAqKk5vdGU6KiogSXQncyB1cCB0byB5b3UgaG93IHlvdSBnb25uYSBoYW5kbGUgcm91dGUgaW4geW91ciBhcHBsaWNhdGlvbiBhbmQgaW1wbGVtZW50IFVJIHRlbXBsYXRlcyBmb3IgZWFjaCBlcnJvci5cbiAgICAgKlxuICAgICAqICMgVXNhZ2VcbiAgICAgKiBTZWUge0BsaW5rIG1tLmVycm9ySHR0cEhhbmRsZXIuZXJyb3JIdHRwSGFuZGxlciN1c2FnZSBgZXJyb3JIdHRwSGFuZGxlcmB9IGZvciBhbiBleGFtcGxlIG9mIGNvbmZpZ3VyaW5nIGFuZCB1c2luZyBgZXJyb3JIdHRwSGFuZGxlcmAuXG4gICAgICpcbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIEBuZ2RvYyBwcm92aWRlclxuICAgICAqIEBuYW1lIGVycm9ySHR0cEhhbmRsZXJQcm92aWRlclxuICAgICAqIEBtb2R1bGUgbW0uZXJyb3JIdHRwSGFuZGxlclxuICAgICAqIEByZXF1aXJlcyBuZy4kd2luZG93XG4gICAgICogQHJlcXVpcmVzIG5nLiRpbmplY3RvclxuICAgICAqIEByZXF1aXJlcyBuZy4kcVxuICAgICAqIEByZXF1aXJlcyBuZy4kbG9jYXRpb25cbiAgICAgKiBAcmVxdWlyZXMgbW0uTG9nZ2VyXG4gICAgICpcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiBVc2UgdGhlIGBlcnJvckh0dHBIYW5kbGVyUHJvdmlkZXJgIHRvIGNvbmZpZ3VyZSB3aGVyZSB0byBwb3N0IGVycm9ycy4gZXJyb3JIdHRwSGFuZGxlclByb3ZpZGVyIGNhbiBwb3N0cyBlcnJvciB0byBgU2VudHJ5YCBvciBzb21lIGN1c3RvbSByZXBvcnRpbmcgdG9vbFxuICAgICAqIHNlZSB1c2FnZSBiZWxvdy5cbiAgICAgKlxuICAgICAqIEB1c2FnZVxuICAgICAqIEJ5IGRlZmF1bHQgcG9zdGluZyBlcnJvciB0byByZXBvcnRpbmcgdG9vbCBpcyB0dXJuIG9mZi4gVGhpcyBjYW4gYmUgdHVybiBvbiBieSBjb25maWd1cmluZyB0aGUgYGVycm9ySHR0cEhhbmRsZXJQcm92aWRlcmAgbGlrZSB0aGlzIChjdXN0b20gcmVwb3J0aW5nIHRvb2wpOlxuICAgICAqXG4gICAgICogYGBganNcbiAgICAgKiAgIGFuZ3VsYXIubW9kdWxlKCdjdXN0b21FcnJvckh0dHBIYW5kbGVyRGVtbycsIFtdKS5jb25maWcoWydlcnJvckh0dHBIYW5kbGVyUHJvdmlkZXInLCBmdW5jdGlvbiAoY2ZnKSB7XG4gICAgICogICAgICBjZmcuc2V0Q29uZmlnQXBwRXJyb3JQcmVmaXgoJ2RlbW9BcHAnKTtcbiAgICAgKiAgICAgIGNmZy5zZXRDb25maWdDdXN0b21EbnMoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9lcnJvcicpO1xuICAgICAqICAgfV0pO1xuICAgICAqIGBgYFxuICAgICAqID4gKipOb3RlOioqIFlvdSBuZWVkIHRvIHByb3ZpZGUgeW91ciBvd24gYmFjayBlbmQgaW1wbGVtZW50YXRpb24gdGhhdCBhY2NlcHQgYHBvc3RgIGpzb24gcmVxdWVzdC5cbiAgICAgKlxuICAgICAqIG9yIHBvc3QgZXJyb3IgdG8gYFNlbnRyeWAgbGlrZSB0aGlzOlxuICAgICAqXG4gICAgICogYGBgaHRtbFxuICAgICAqIDxzY3JpcHQgc3JjPVwiLy9jZG4ucmF2ZW5qcy5jb20vMS4xLjE1L3JhdmVuLm1pbi5qc1wiPjwvc2NyaXB0PlxuICAgICAqIGBgYFxuICAgICAqIGBgYGpzXG4gICAgICogICBhbmd1bGFyLm1vZHVsZSgnc2VudHJ5RXJyb3JIdHRwSGFuZGxlckRlbW8nLCBbXSkuY29uZmlnKFsnZXJyb3JIdHRwSGFuZGxlclByb3ZpZGVyJywgZnVuY3Rpb24gKGNmZykge1xuICAgICAqICAgICAgdmFyIHJhdmVuQ29uZmlnID0ge2xvZ2dlcjogJ2phdmFzY3JpcHQnfTtcbiAgICAgKiAgICAgIGNmZy5zZXRDb25maWdBcHBFcnJvclByZWZpeCgnZGVtb0FwcCcpO1xuICAgICAqICAgICAgY2ZnLnNldENvbmZpZ1JhdmVuRG5zKCdodHRwczovLzdiZS4uLi4uLi4uLi4uLi4uLjQ5MUBhcHAuZ2V0c2VudHJ5LmNvbS8yLi4uMicpO1xuICAgICAqICAgICAgY2ZnLnNldENvbmZpZ1JhdmVuQ29uZmlnKHJhdmVuQ29uZmlnKTtcbiAgICAgKiAgIH1dKTtcbiAgICAgKiBgYGBcbiAgICAgKiA+ICoqTm90ZToqKiBZb3UgbmVlZCB0byBjcmVhdGUgU2VudHJ5IGFjY291bnQgdG8gYmUgYWJsZSB0byBzZW5kIGVycm9yIGRhdGEgdG8ge0BsaW5rIGh0dHBzOi8vZ2V0c2VudHJ5LmNvbS8gYFNlbnRyeWApLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVycm9ySHR0cEhhbmRsZXJQcm92aWRlcigpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgICAgICogRXJyb3IgaHR0cCBoYW5kbGVyIGNvbmZpZ3VyYXRpb24uIGFwcEVycm9yUHJlZml4IGlzIG9wdGlvbmFsIHR5cGUuIElmIHlvdSB3YW50IHRvIHVzZSBlcnJvciByZXBvcnRpbmcgdG9vbCB0aGVuIGF0XG4gICAgICAgICAqIGxlYXN0IG9uZSBvZiB0aGUgYHJhdmVuRG5zYCBvciBgY3VzdG9tRG5zYCBoYXMgdG8gYmUgZGVmaW5lZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge3thcHBFcnJvclByZWZpeDogc3RyaW5nLCByYXZlbkRuczogbnVsbCwgcmF2ZW5Db25maWc6IG51bGwsIGN1c3RvbURuczogbnVsbH19XG4gICAgICAgICAqL1xuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICcnLCAvLyBvcHRpb25hbFxuICAgICAgICAgICAgcmF2ZW5EbnM6IG51bGwsXG4gICAgICAgICAgICByYXZlbkNvbmZpZzogbnVsbCwgLy8gb3B0aW9uYWxcbiAgICAgICAgICAgIGN1c3RvbURuczogbnVsbFxuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyI3NldENvbmZpZ0FwcEVycm9yUHJlZml4XG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBTZXQgYXBwIGVycm9yIHByZWZpeC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmc9fSBfYXBwRXJyb3JQcmVmaXggLSBhbiBvcHRpb25hbCBhcHAgZXJyb3IgcHJlZml4XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNldENvbmZpZ0FwcEVycm9yUHJlZml4ID0gZnVuY3Rpb24oX2FwcEVycm9yUHJlZml4KSB7XG4gICAgICAgICAgICBjb25maWcuYXBwRXJyb3JQcmVmaXggPSBfYXBwRXJyb3JQcmVmaXggfHwgY29uZmlnLmFwcEVycm9yUHJlZml4O1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyI3NldENvbmZpZ0FwcEVycm9yUHJlZml4XG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBTZXQgdGhlIHJhdmVuIEROUy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IF9yYXZlbkRucyAtIGFuIHZhbGlkIHJhdmVuIEROU1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZXRDb25maWdSYXZlbkRucyA9IGZ1bmN0aW9uKF9yYXZlbkRucykge1xuICAgICAgICAgICAgaWYgKCFfcmF2ZW5EbnMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JhdmVuRE5TIG11c3QgYmUgc2V0IScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uZmlnLnJhdmVuRG5zID0gX3JhdmVuRG5zO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxuICAgICAgICAgKiBAbmFtZSAkZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyI3NldENvbmZpZ1JhdmVuQ29uZmlnXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBTZXQgdGhlIHJhdmVuIGNvbmZpZyBvcHRpb25zLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdPX0gX3JhdmVuQ29uZmlnIC0gYW4gb3B0aW9uYWwgYXJyYXkgb2YgcmF2ZW4gY29uZmlnIG9wdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2V0Q29uZmlnUmF2ZW5Db25maWcgPSBmdW5jdGlvbihfcmF2ZW5Db25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5yYXZlbkNvbmZpZyA9IF9yYXZlbkNvbmZpZyB8fCBjb25maWcucmF2ZW5Db25maWc7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXG4gICAgICAgICAqIEBuYW1lICRleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIjc2V0Q29uZmlnQ3VzdG9tRG5zXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAgICAgKiBTZXQgdGhlIGN1c3RvbSBkbnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBfY3VzdG9tRG5zIC0gYW4gdmFsaWQgY3VzdG9tIEROU1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZXRDb25maWdDdXN0b21EbnMgPSBmdW5jdGlvbihfY3VzdG9tRG5zKSB7XG4gICAgICAgICAgICBpZiAoIV9jdXN0b21EbnMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0N1c3RvbWVETlMgbXVzdCBiZSBzZXQhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25maWcuY3VzdG9tRG5zID0gX2N1c3RvbURucztcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLiRnZXQgPSBbJyRpbmplY3RvcicsICckcScsICckbG9jYXRpb24nLCAnJHdpbmRvdycsICdMb2dnZXInLCBmdW5jdGlvbiAoJGluamVjdG9yLCAkcSwgJGxvY2F0aW9uLCAkd2luZG93LCBMb2dnZXIpIHtcbiAgICAgICAgICAgIHZhciBsb2dnZXIgPSBMb2dnZXIuZ2V0TG9nZ2VyKCckZXhjZXB0aW9uSGFuZGxlcicpO1xuXG4gICAgICAgICAgICB2YXIgYnJvd3NlckluZm8gPSB7XG4gICAgICAgICAgICAgICAgbmF2aWdhdG9yQXBwTmFtZSA6IG5hdmlnYXRvci5hcHBOYW1lLFxuICAgICAgICAgICAgICAgIG5hdmlnYXRvclVzZXJBZ2VudCA6IG5hdmlnYXRvci51c2VyQWdlbnRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoJHdpbmRvdy5SYXZlbikge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdVc2luZyB0aGUgUmF2ZW5KUyBzZXJ2ZXItc2lkZSBsb2dnaW5nIGV4Y2VwdGlvbiBoYW5kbGVyLicpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdSYXZlbkpTIHJhdmVuRG5zIHswfScsIFtjb25maWcucmF2ZW5EbnNdKTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygnUmF2ZW5KUyByYXZlbkNvbmZpZyB7MH0nLCBbY29uZmlnLnJhdmVuQ29uZmlnXSk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uZmlndXJlIFJhdmVuXG4gICAgICAgICAgICAgICAgICAgIFJhdmVuLmNvbmZpZyhjb25maWcucmF2ZW5EbnMsIGNvbmZpZy5yYXZlbkNvbmZpZykuaW5zdGFsbCgpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGxvZ2dpbmdFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHRvIGNvbmZpZ3VyZSBSYXZlbkpTJyk7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihsb2dnaW5nRXJyb3IudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmKGNvbmZpZy5jdXN0b21EbnMpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygnVXNpbmcgdGhlIGN1c3RvbSBzZXJ2ZXItc2lkZSBsb2dnaW5nIGV4Y2VwdGlvbiBoYW5kbGVyLicpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdDdXN0b20gRE5TIHswfScsIFtjb25maWcuY3VzdG9tRG5zXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlamVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR3aW5kb3cuUmF2ZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3N0IGVycm9yIHRvIFNlbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJhdmVuLmNhcHR1cmVFeGNlcHRpb24obmV3IEVycm9yKCdIVFRQIHJlc3BvbnNlIGVycm9yJyksIHtleHRyYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHJlamVjdGlvbi5jb25maWcubWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHJlamVjdGlvbi5jb25maWcudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZWplY3Rpb24uZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZWplY3Rpb24uc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm93c2VySW5mbzogYnJvd3NlckluZm99XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29uZmlnLmN1c3RvbURucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzaW5nIHRoZSAkaW5qZWN0b3Igc2VydmljZSBkaXJlY3RseSB0byBhdm9pZCBhIGNpcmN1bGFyIGRlcGVuZGVuY3lcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGh0dHBCYWNrZW5kID0gJGluamVjdG9yLmdldCgnJGh0dHBCYWNrZW5kJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBieXBhc3NpbmcgYW5ndWxhcidzIGh0dHAgYWJzdHJhY3Rpb24gdG8gYXZvaWQgaW5maW5pdGUgZXhjZXB0aW9uIGxvb3BzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHBCYWNrZW5kKCdQT1NUJywgY29uZmlnLmN1c3RvbURucywgYW5ndWxhci50b0pzb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IHJlamVjdGlvbi5jb25maWcubWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHJlamVjdGlvbi5jb25maWcudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZWplY3Rpb24uZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZWplY3Rpb24uc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm93c2VySW5mbzogYnJvd3NlckluZm9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgYW5ndWxhci5ub29wLCB7ICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGxvZ2dpbmdFcnJvcil7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHNlcnZlci1zaWRlIGxvZ2dpbmcgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobG9nZ2luZ0Vycm9yLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocmVqZWN0aW9uLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy80MDQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ3swfSB7MX0gXFwnezJ9XFwnJywgW3JlamVjdGlvbi5zdGF0dXMsIHJlamVjdGlvbi5zdGF0dXNUZXh0LCByZWplY3Rpb24uY29uZmlnLnVybF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE8gKG1hcnRpbik6IHRoaXMgZXJyb3Igc2hvdWxkIGJlIGN1c3RvbSBlcnJvciBwYWdlIGFuZCBub3QgNTAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy81MDAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ3swfSB7MX0gezJ9IFxcJ3szfVxcJycsIFtyZWplY3Rpb24uc3RhdHVzLCByZWplY3Rpb24uc3RhdHVzVGV4dCwgcmVqZWN0aW9uLmNvbmZpZy51cmwsICdVbmFibGUgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmVyLiBNYWtlIHN1cmUgeW91IGFyZSBjb25uZWN0ZWQgdG8gdGhlIGludGVybmV0IGFuZCB0cnkgYWdhaW4uJ10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLzUwMCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignezB9IHsxfSB7Mn0gXFwnezN9XFwnJywgW3JlamVjdGlvbi5zdGF0dXMsIHJlamVjdGlvbi5zdGF0dXNUZXh0LCByZWplY3Rpb24uY29uZmlnLnVybCwgcmVqZWN0aW9uLmRhdGEubWVzc2FnZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVqZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XTtcbiAgICB9XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ21tLmVycm9ySHR0cEhhbmRsZXInLCBbJ21tLmxvZ2dlciddKVxuICAgICAgICAucHJvdmlkZXIoJ2Vycm9ySHR0cEhhbmRsZXInLCBlcnJvckh0dHBIYW5kbGVyUHJvdmlkZXIpXG4gICAgICAgIC5jb25maWcoZnVuY3Rpb24gKCRodHRwUHJvdmlkZXIpIHtcbiAgICAgICAgICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2Vycm9ySHR0cEhhbmRsZXInKTtcbiAgICAgICAgfSk7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9